# [0018. 3ts](https://github.com/Tdahuyou/TNotes.notes/tree/main/notes/0018.%203ts)

<!-- region:toc -->

- [1. ğŸ“ æ¦‚è¿°](#1--æ¦‚è¿°)
- [2. ğŸ“º TNotes.yuque](#2--tnotesyuque)
- [3. ğŸ“’ 3ts ç®€ä»‹](#3--3ts-ç®€ä»‹)
- [4. ğŸ“ æ—¥å¿— - chrome åº”ç”¨å•†åº—æ³¨å†Œæˆä¸ºå¼€å‘è€…éœ€è¦ä»˜è´¹ 5 ç¾å…ƒ](#4--æ—¥å¿—---chrome-åº”ç”¨å•†åº—æ³¨å†Œæˆä¸ºå¼€å‘è€…éœ€è¦ä»˜è´¹-5-ç¾å…ƒ)
- [5. ğŸ’» 3ts å®ç°æºç ](#5--3ts-å®ç°æºç )

<!-- endregion:toc -->

## 1. ğŸ“ æ¦‚è¿°

- è¿™æ˜¯ç”¨ gpt æ’¸çš„ä¸€ä¸ª chrome æ’ä»¶ï¼Œå·²ç˜«ç—ªä¸å¯ç”¨ã€‚
- æ–‡æ¡£è®¡åˆ’å…ˆç•™ç€ï¼Œåç»­å¯èƒ½è¿˜æœ‰ç‚¹å„¿ç”¨ã€‚

## 2. ğŸ“º TNotes.yuque

- åœ¨ TNotes.yuque ä¸Šè®°å½•äº†ä»‹ç» 3ts çš„è§†é¢‘ã€‚
- ![å›¾ 0](https://cdn.jsdelivr.net/gh/Tdahuyou/imgs@main/2025-05-06-02-54-21.png)

## 3. ğŸ“’ 3ts ç®€ä»‹

- TTSï¼š
  - Text To Speech
- åŠŸèƒ½ä»‹ç»
  - ä½¿ç”¨çš„éŸ³é¢‘æ˜¯ç³»ç»Ÿã€æµè§ˆå™¨è‡ªå¸¦çš„éŸ³é¢‘ï¼Œå› æ­¤æ— éœ€ä»˜è´¹ï¼ˆéŸ³é¢‘è´¨é‡å ªå¿§ï¼‰ï¼Œä½†ä¸åŒçš„æ“ä½œç³»ç»Ÿå’Œæµè§ˆå™¨ï¼ŒéŸ³é¢‘å¯èƒ½ä¼šæœ‰æ‰€ä¸åŒã€‚
- å®‰è£…æ–¹å¼
  - ä½¿ç”¨ chrome æµè§ˆå™¨æ‰“å¼€ ğŸ‘‰ğŸ» `chrome://extensions/`
  - ä¸‹è½½æ’ä»¶å®‰è£…åŒ…å¹¶å¼•å…¥
    - æ’ä»¶çš„å®‰è£…åŒ…è®°å½•åœ¨ TNotes.yuque ä¸Šã€‚
- ä½¿ç”¨åœºæ™¯
  - å› ç³»ç»Ÿè‡ªå¸¦çš„éŸ³é¢‘è´¨é‡ä¸å¤ªè¡Œï¼Œæƒ³è¦ä½“éªŒè¿˜è¿‡å¾—å»ï¼Œèƒ½ç”¨çš„åœºæ™¯æ¯”è¾ƒæœ‰é™ã€‚
  - é€‚åˆçŸ­å†…å®¹ï¼Œæ¯”å¦‚ï¼šè¯»ç½‘é¡µä¸Šçš„å•è¯ or è¯ç»„
  - ä¸é€‚åˆé•¿å†…å®¹ï¼Œæ¯”å¦‚ï¼šè¯»å®Œæ•´çš„å¥å­ï¼ˆå¬èµ·æ¥ä¼šæœ‰äº›å¥‡æ€ªï¼‰
  - å®æµ‹äº†ä¸€ä¸‹ï¼Œå…¶å®è›®å¤šç¿»è¯‘å·¥å…·ï¼Œå®ƒä»¬ç”¨çš„ä¹Ÿæ˜¯å’‹ä»¬ç³»ç»Ÿè‡ªå¸¦çš„éŸ³é¢‘ï¼Œæ¯”å¦‚ [fanyi.baidu](https://fanyi.baidu.com/#en/zh)

## 4. ğŸ“ æ—¥å¿— - chrome åº”ç”¨å•†åº—æ³¨å†Œæˆä¸ºå¼€å‘è€…éœ€è¦ä»˜è´¹ 5 ç¾å…ƒ

- è‡ªå·±å†™çš„å·¥å…· 3tsï¼Œå°šæœªä¸Šä¼ è‡³ chrome åº”ç”¨å•†åº—ä¸­
- æœ¬æƒ³ä¸Šä¼ ï¼Œä½†æ˜¯å°è¯•äº†ä¸€ä¸‹ï¼Œå‘ç°éœ€è¦ 5 ç¾å…ƒæ³¨å†Œè´¹ï¼Œäºæ˜¯â€¦â€¦

![å›¾ 1](https://cdn.jsdelivr.net/gh/Tdahuyou/imgs@main/2025-05-06-03-00-32.png)

> å½“æ—¶å†™è¿™ä¸ªæ’ä»¶çš„æ—¶å€™æ²¡ä»˜é’±æ³¨å†Œï¼Œåæ¥æ³¨å†Œäº†ä¸€ä¸ªè´¦å·ï¼ŒåŸºæœ¬çš„æ³¨å†Œæµç¨‹ä»¥åŠå‘å¸ƒæ’ä»¶çš„ä¸€äº›æ³¨æ„äº‹é¡¹å•¥çš„ï¼Œå¥½åƒæ˜¯æœ‰å†™è¿‡ä¸€äº›ç¬”è®°æ¥è®°å½•çš„ã€‚

## 5. ğŸ’» 3ts å®ç°æºç 

::: code-group

```json [manifest.json]
{
  "manifest_version": 3,
  "name": "3ts",
  "version": "1.0",
  "description": "Speak selected text",
  "permissions": ["contextMenus", "activeTab", "scripting", "storage"],
  "background": {
    "service_worker": "background.js"
  },
  "action": {
    "default_popup": "popup.html",
    "default_icon": {
      "16": "imgs/icon_3ts_16.png",
      "48": "imgs/icon_3ts_48.png",
      "128": "imgs/icon_3ts_128.png"
    }
  },
  "icons": {
    "16": "imgs/icon_3ts_16.png",
    "48": "imgs/icon_3ts_48.png",
    "128": "imgs/icon_3ts_128.png"
  }
}
// å›¾æ ‡æ–‡ä»¶å°±æ˜¯ä¸€ä¸ªå–‡å­ï¼Œå¯ä»¥åˆ°ä¸€äº›å…è´¹çš„å›¾æ ‡ç«™ç‚¹ä¸­éšä¾¿æ‹‰ä¸€ä¸ªä¸‹æ¥ã€‚
```

```js [popup.js]
const selectVoice = document.getElementById('selectVoice')

window.speechSynthesis.onvoiceschanged = () => {
  const voices = window.speechSynthesis.getVoices()
  for (let i = 0; i < voices.length; i++) {
    const option = document.createElement('option')
    option.textContent = voices[i].name
    selectVoice.appendChild(option)
  }

  selectVoice.value = voices[0].name

  chrome.storage.sync.get(['voice'], (result) => {
    const v = result.voice
    if (v) selectVoice.value = v
  })
}

selectVoice.addEventListener('change', () => {
  chrome.storage.sync.set({
    voice: selectVoice.value,
  })
})
```

```html [popup.html]
<head>
  <style>
    .label {
      font-weight: bold;
      padding-bottom: 1rem;
    }
  </style>
</head>

<body>
  <h1 style="text-align: center;">3ts</h1>
  <div class="label">Voice</div>
  <select id="selectVoice"></select>
</body>

<script src="./popup.js"></script>
```

```js [background.js]
function speakText(text) {
  console.log('call speakText', text)
  chrome.storage.sync.get(['voice'], ({ voice: v }) => {
    console.log('voice:', v)
    var utterance = new SpeechSynthesisUtterance(text)
    if (v) {
      utterance.voice = window.speechSynthesis
        .getVoices()
        .find((voice) => voice.name === v)
    }
    window.speechSynthesis.speak(utterance)
  })
}

chrome.runtime.onInstalled.addListener(() => {
  chrome.contextMenus.create({
    id: 'speak',
    title: 'Speak',
    contexts: ['selection'],
  })
})

chrome.contextMenus.onClicked.addListener(function (info, tab) {
  if (info.menuItemId === 'speak') {
    chrome.scripting.executeScript({
      target: {
        tabId: tab.id,
      },
      function: speakText,
      args: [info.selectionText],
    })
  }
})
```

:::
